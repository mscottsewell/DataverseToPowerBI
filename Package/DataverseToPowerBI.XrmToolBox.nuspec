<?xml version="1.0"?>
<package>
	<metadata>
    <id>DataverseToPowerBI.XrmToolBox</id>
    <version>1.2026.5.113</version>
    <title>Dataverse to Power BI Semantic Model</title>
    <authors>Scott Sewell</authors>
    <owners>mScottSewell</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <license type="expression">MIT</license>
    <description>Extract Dataverse metadata and generate Power BI TMDL/PBIP semantic models with automatic table relationships, calendar tables, and incremental change detection.</description>
    <summary>XrmToolBox plugin for generating Power BI semantic models from Dataverse metadata</summary>
    <releaseNotes>
  v1.2026.5.110 — Sweeping bugfix and stability release focused on incremental update safety, lineage stability, and output hygiene.

Highlights:
- Fixed TMDL description preservation so table/column descriptions are no longer stripped during write (relationship descriptions still sanitized for Power BI Desktop compatibility)
- Fixed null-safety in lookup type checks (`IsLookupType` / `IsPolymorphicLookupType`) to prevent potential null reference failures
- Made FetchXML debug output opt-in (`enableFetchXmlDebugLogs`) to avoid writing sensitive filter data by default
- Stabilized lineage across Dataverse display-name renames via logical-name annotation fallback
- Consolidated duplicated environment-name extraction logic into shared `UrlHelper`

Quality:
- Added 28 FetchXmlToSqlConverter unit tests across operators, nested logic, link-entity behavior, and edge cases
- Added 12 integration tests for incremental-update preservation (lineage, descriptions, user measures, annotations)
- Removed experimental PPTB (Power Platform Toolbox) port from active codebase

  v1.2026.5.101 — Lookup sub-column configuration, polymorphic lookup support, cross-chain ambiguity detection, and relationship selector enhancements.

New Features:
- Per-lookup sub-column configuration: control which generated columns (ID, Name, Type, Yomi) are included or hidden, with smart defaults based on relationship status
- Collapsible lookup groups in the attribute list with Include/Hidden toggles per sub-column
- Full Owner/Customer polymorphic lookup support with Type and Yomi sub-columns
- Cross-chain ambiguity detection in relationship selector (same target reachable via multiple active paths)
- Source Table column added to relationship selector for multi-source clarity
- Dimension chain grouping in relationship selector (direct + snowflake descendants grouped together)
- Snowflake table tracking for deeper chaining support (Fact → Dim → Snowflake → Snowflake2)

UI/UX Improvements:
- Renamed "Incl"/"Hid" column headers to "Include"/"Hidden" with rebalanced column widths
- Removed non-functional empty checkboxes from lookup sub-rows
- GUID/ID Include checkbox read-only (grayed) on lookups supporting a defined relationship
- Expand Lookup feature always enabled (removed experimental gate)
- User-added relationship marker comment in preserved TMDL relationships
- Auto-check prevention when re-editing existing fact table relationships

Bug Fixes:
- Relationship lookup GUID now correctly defaults to Include+Hidden (stale configs no longer override smart defaults)
- Relationship-required columns auto-added to selected attributes and build output
- Cross-chain relationship status refresh prevents stale highlighting
- Polymorphic virtual columns filtered from TMDL output to prevent duplicates
- Select All/Deselect All skip internal sub-row tags

  v1.2026.5.84 — Fixed expanded-lookup SQL JOIN generation to always use related table logical/schema names (not display names), preventing invalid SQL when views include related-table columns.
  v1.2026.5.83 — Quick Select now preserves current All/Selected filter mode and refreshes selections in-place. Fixed selected-attribute persistence after reopen by using case-insensitive selection sets and removing view-mode default reapply during metadata load/revalidation. Expanded child row Default checkmarks now require strict selected-view linked-column matches. Added automatic normalization/upgrade of saved expanded lookup display metadata on load.
  v1.2026.5.62 — Fixed FabricLink expanded multi-select label resolution: uses OUTER APPLY + STRING_SPLIT + STRING_AGG with metadata JOINs (matching regular multi-select behavior).
  v1.2026.5.61 — Expand Lookups: denormalize related table fields via LEFT OUTER JOIN. CSV documentation export for model review/audit. Export flow redesign (JSON or CSV format selection).
  v1.2026.5.60 — Fixed FabricLink multi-select choice label joins (semicolon split + OptionSetName uses attribute logical name).
  v1.2026.5.56 — Updated package metadata and icons - fixed problem with CR/LF in description fields causing schema validation errors in Power BI Desktop.        
  v1.2026.5.54 — Renamed repository and updated package metadata.
  v1.2026.5.37 — Bug fix release addressing TMDL compatibility and relationship dialog stability.

Bug Fixes Since v1.2026.5.21:
- Fixed Power BI Desktop schema validation errors caused by 'description' properties on relationships (not supported in Feb 2026 builds)
- Fixed automatic resolution of ambiguous relationship paths (multiple active relationships to same target now auto-resolved)
- Fixed NullReferenceException crashes in relationship selector dialog when checking/unchecking relationships
- Fixed relationship active/inactive state tracking to use tag property instead of ListView control state
- Fixed "Solution tables only" filter hiding already-selected relationships to out-of-solution tables
- Fixed duplicate 'mode:' line in generated table partition TMDL
- Added user confirmation prompts when selecting relationships that conflict with existing active relationships

Previous Release (v1.2026.5.21):
- Storage Mode Support — DirectQuery, Dual (All/Select), and Import mode per semantic model with per-table overrides
- Export/Import Configurations — Share model configs as JSON files between machines or team members
- Change Preview Redesign — Grouped TreeView with impact analysis, filter toggles, and detail pane
- Incremental Update Preservation — LineageTags, user relationships, column descriptions, formatting, annotations preserved
- Table Rename Detection — Detects renamed tables and carries over customizations
- Vista Folder Picker — Modern Explorer-style folder dialogs
- Date Relationship Dedup — Stale date relationships automatically cleaned up
- Attribute List Performance — Pre-sorted cache for instant table/filter switching
    </releaseNotes>
    <tags>XrmToolBox PowerBI Dataverse TMDL PBIP SemanticModel</tags>
    <projectUrl>https://github.com/mscottsewell/DataverseToPowerBI</projectUrl>
    <iconUrl>https://raw.githubusercontent.com/mscottsewell/DataverseToPowerBI/main/Images/DataverseToPowerBI_128.png</iconUrl>
    <dependencies>
        <group targetFramework="net48">
            <dependency id="XrmToolBox" version="[1.2025.10.74,)" />
        </group>
    </dependencies>
  </metadata>
  <files>
    <file src="DataverseToPowerBI.XrmToolBox\bin\Release\DataverseToPowerBI.XrmToolBox.dll" target="lib\net48\Plugins\" />
    <file src="DataverseToPowerBI.Core\bin\Release\net48\DataverseToPowerBI.Core.dll" target="lib\net48\Plugins\" />
    <file src="DataverseToPowerBI.XrmToolBox\Assets\PBIP_DefaultTemplate\**\*.*" target="lib\net48\Plugins\DataverseToPowerBI\PBIP_DefaultTemplate\" />
    <file src="DataverseToPowerBI.XrmToolBox\Assets\Icons\**\*.*" target="lib\net48\Plugins\DataverseToPowerBI\Icons\" />
    <file src="README.md" target="README.md" />
    <file src="LICENSE" target="LICENSE" />
  </files>
</package>   
