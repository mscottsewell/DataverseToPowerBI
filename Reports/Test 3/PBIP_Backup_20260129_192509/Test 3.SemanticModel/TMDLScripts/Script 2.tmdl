createOrReplace

	/// Source: cai_allocationperiod
	table 'Allocation Period'
		lineageTag: 5f19413a-3132-4e41-ad79-b192a087e27c

		/// cai_allocationperiodid
		column cai_allocationperiodid
			dataType: string
			isHidden
			isKey
			sourceProviderType: uniqueidentifier
			lineageTag: e5bf1187-4921-4ef0-b7b9-b09727495ef1
			summarizeBy: none
			sourceColumn: cai_allocationperiodid

			annotation SummarizationSetBy = Automatic

		/// cai_allocationperiod_end
		column 'Allocation Period End'
			dataType: dateTime
			formatString: Short Date
			sourceProviderType: datetime2
			lineageTag: ccc07bf8-f73d-4b9b-8e0d-050cfb232d23
			summarizeBy: none
			sourceColumn: cai_allocationperiod_end

			changedProperty = DataType

			annotation SummarizationSetBy = Automatic

			annotation UnderlyingDateTimeDataType = Date

		/// cai_allocationperiod_start
		column 'Allocation Period Start'
			dataType: dateTime
			formatString: Short Date
			sourceProviderType: datetime2
			lineageTag: 07f17d56-286a-4dd3-8059-800a9a2fa847
			summarizeBy: none
			sourceColumn: cai_allocationperiod_start

			changedProperty = DataType

			annotation SummarizationSetBy = Automatic

			annotation UnderlyingDateTimeDataType = Date

		/// cai_fiscalyearname
		column 'Fiscal Year'
			dataType: string
			sourceProviderType: nvarchar
			lineageTag: b6103f8b-4c1a-4d9c-a5b0-2771c53e785d
			summarizeBy: none
			sourceColumn: cai_fiscalyearname

			annotation SummarizationSetBy = Automatic

		/// ownerid
		column ownerid
			dataType: string
			isHidden
			sourceProviderType: uniqueidentifier
			lineageTag: 2f86e418-8174-43ae-b920-414b43b8663d
			summarizeBy: none
			sourceColumn: ownerid

			annotation SummarizationSetBy = Automatic

		/// owneridname
		column Owner
			dataType: string
			sourceProviderType: nvarchar
			lineageTag: 5a342bc8-7aaf-4778-bf2b-a8865943f5f3
			summarizeBy: none
			sourceColumn: owneridname

			annotation SummarizationSetBy = Automatic

		/// cai_periodname
		column 'Period Name'
			dataType: string
			sourceProviderType: nvarchar
			lineageTag: 35e83b74-ca39-49c5-8c38-c0c30521bd15
			isDefaultLabel
			summarizeBy: none
			sourceColumn: cai_periodname

			annotation SummarizationSetBy = Automatic

		partition 'Allocation Period' = m
			mode: directQuery
			source =
					let
					    Dataverse = CommonDataService.Database(DataverseURL,[CreateNavigationProperties=false]),
					    Source = Value.NativeQuery(Dataverse,"
					
					    -- View Filter: Current + Last 3 Allocation Periods
					
					    SELECT Base.cai_allocationperiodid
					        ,Base.cai_allocationperiod_end
					        ,Base.cai_allocationperiod_start
					        ,Base.cai_fiscalyearname
					        ,Base.ownerid
					        ,Base.owneridname
					        ,Base.cai_periodname
					    FROM cai_AllocationPeriod as Base
					    WHERE (Base.statecode = 0 AND (DATEADD(hour, -6, Base.cai_allocationperiod_start) >= DATEADD(month, DATEDIFF(month, 0, DATEADD(hour, -6, GETUTCDATE())) - 4, 0) AND DATEADD(hour, -6, Base.cai_allocationperiod_start) < DATEADD(month, DATEDIFF(month, 0, DATEADD(hour, -6, GETUTCDATE())) + 1, 0)))
					
					    " ,null ,[EnableFolding=true])
					in
					    Source

		annotation PBI_NavigationStepName = Navigation

		annotation PBI_ResultType = Table

