// =============================================================================
// TmdlPluginTool.cs - XrmToolBox Plugin Entry Point
// =============================================================================
// Purpose: Plugin metadata and factory class for XrmToolBox integration.
//
// This class uses MEF (Managed Extensibility Framework) attributes to register
// the plugin with XrmToolBox. The ExportMetadata attributes define:
//   - Plugin name and description
//   - Icon images (small and big, Base64 encoded PNG)
//   - Color scheme for the plugin tile
//
// XrmToolBox Integration:
//   - Inherits from PluginBase (XrmToolBox.Extensibility)
//   - Implements GetControl() to return the plugin's UI control
//   - Uses MEF [Export] to be discovered by XrmToolBox
//
// The actual plugin UI is in PluginControl.cs.
// =============================================================================

using System;
using System.ComponentModel.Composition;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace DataverseToPowerBI.XrmToolBox
{
    /// <summary>
    /// XrmToolBox plugin metadata and factory class.
    /// </summary>
    /// <remarks>
    /// <para>
    /// This class registers the plugin with XrmToolBox using MEF attributes.
    /// It provides the plugin's display name, description, and icon images.
    /// </para>
    /// <para>
    /// When the user opens the plugin, XrmToolBox calls GetControl() to
    /// instantiate the plugin UI (PluginControl).
    /// </para>
    /// </remarks>
    [Export(typeof(IXrmToolBoxPlugin)),
     ExportMetadata("Name", "Dataverse to Power BI Semantic Model"),
     ExportMetadata("Description", "Extract Dataverse metadata and generate Power BI TMDL/PBIP semantic models"),
     ExportMetadata("SmallImageBase64", "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURTkwFzY5OUM7MUZFPFNENGBKOi41UTs7WQkPcxQIbx0FcRYZey8AbScbdDgXdjYzczIgcVI5XEY5SXcrRHcsU341XE4TcVkca08ielkldmkka3cramomdngtdXw4eDhNXzdKbTVLe0xRUktJSkFOeExMZVxGZWBecXZTe1JpdWVlaGtqeXVmdW5xdnV0eIkwWJo2U6U8VIQwboMpZog4e6w/YopBXrZKSLhKTa5DVbVGV65BaLlKZ6pEeYtrbpRubpx0bIVpd6J4bctaTMFPUctYVthqSd12RNlnVOV5SONtVet6VtRffs1YZ8lYedR3ddtma8p+aNloeOJvbOZ4auJvdOd6cn2Ie/KGPu+KSfKKSfOGWPuVWdSQbNGGa++Ca/WHZv+XZBAcjwcbhy4ciQsgix0nggYomxkmkh43njs9jRQurA4tqAk1rQQ4tjYioTMutkovlVoqiFc0mmsvjGcyjHc1hmUvm3c2lE4vrFkypUgztlk1uGo1qHU3pGg4tz9chyNcij1DkztYkgNDvR1ItzZPqzNVujprq0dWlHZAiFZviXNtgWtvi2xxhWx7mHFzlnBQv3Rbt0tjuwY9wiM1xzk6xzY810c4ylY4yUI51lY61RRS1ANHyBBGzgBdzwFV2C9E3AB70xxp2Dtx0SJkxxdV8wVZ5RpV9ShI5zZH5DpW7CxW8jxY8hlq8QFm5wV66wRr+QN5/hd6+Cxq/zdk+yV2/VBd1VhYyUlE3VdI22ZDxXdJyGZJ1Etl2UpvxlJl3UJV7UZN5Js+moQ3iJU8ioQ2laI/iYw+roc9uJ9cjbRPkrlNiqdFm7ZMlpZDqpxdpIZLu5NKt6NGqaNOscdZidJeh8VWlNdog4JKwmyEmXGBmgKH2gCC6RmH6gWI/xiJ/geX/heX/iSI/iGX/gSn/xeo/gS3/xm1/iCi/SO4/HCP3W2F3W+Q3Hic3Wyr3HSl3AfC/yHD/YqOjrKqnpeNsqqboLa6tKOlssuclsiqqMLEvpCSz5mY16Oy0AAAAE7ISxQAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgNS4xLjExiggWzgAAALhlWElmSUkqAAgAAAAFABoBBQABAAAASgAAABsBBQABAAAAUgAAACgBAwABAAAAAgAAADEBAgARAAAAWgAAAGmHBAABAAAAbAAAAAAAAABgAAAAAQAAAGAAAAABAAAAUGFpbnQuTkVUIDUuMS4xMQAAAwAAkAcABAAAADAyMzABoAMAAQAAAAEAAAAFoAQAAQAAAJYAAAAAAAAAAgABAAIABAAAAFI5OAACAAcABAAAADAxMDAAAAAABjXUc7KPcjsAAAM9SURBVDhPY/iPAf68efP67bt37959+PD+338GdOn/fzdvuv/w4dOnT58/f/7x1Q9sCh4/efLo0bNnL569ePHqNhYFD0DST8FGfHzVj0XB/QcPHz6F2oFVwebHDx6BHfH0+fNXtzAV/Jm/dPGiezATsCj4osXEqNl459nT5x8/fvyEpODrpIk7tm8/cGByZ3Nbg1IH2AgUBZP27Nm789DqNau3btu8oVv37jOQLz4hOXLH7ol79u46dHDt1i2PHygobHj49Onzpy+QFEy6eHHP7r27Dq3duvXJo2aVDY9AljxDCqgLVy7dBBlxaO3WLZs7NO+CvPrwJZIJF65curhnL9iILdva5e89ePDw0cOXExAKTh2V66oDGbF269bN+7s3PHjw6NHDJwgFv/VYGJiVJXfv3Hnw4NYtSxs3P3hw/+HDJ/0Mv8LC/INu3Lh63VbuSJeaUtXsnatWr1m2pHv9pvsgBRMY/BPCQm/cuHb9+rkrl06WKBXPnrVq1ZoVS+XXb9p0//79B/0McQlhoUE3rl09d/nyiZMljMUzZ01ftXJFu/zyTSAVDyYwxCXGB4f6XLt2/dzl8ycqhMpnzpg+feXKdsUFGzdu2gRWkJAQHBrqc/X6ubOXT1QwFdXMmDV9+sK2prnLlm/cuGkzyISE+JDgIL+rp8+ePV8hWFo/c8a0aVObsqbMWb58/frFvQyxiQkJIcEBflfPnD57+IhGRT1IxdQs1bx58xYshyiISYgPCfD187M9fvSoWkVdbWV1dQE/W86UuXPnLpjTB1IQHe3t5eprY2173ETtSEVtVWVlPr9SenbelJaW1j6GwBiwAg9XGxtbW31muWMV5YWF+exKydk52bl5rbpgBd4gBa42NtbCLKImZSVFEnxCypwZSenp6Zm6DHFRUdHe3m4ezi5WVqb6rCJGsjIgBUJcKdxJqckZugyBEZ6enm5ubs4WFpaGBlqiRrIy4hI86rqcvLzc3MlpugyBUZ7u7m4gE8wtDQ10zYylpcQleHrCOQV4ecEKfoLl3bwgRmiZ6RtLS8nw6IVzCYBU8Osx/P/l5ODg5OTk5OBgb2f3+Zujo46Ojo7e98892tra2nr/AeKMkA3I+HizAAAAAElFTkSuQmCC"),
     ExportMetadata("BigImageBase64", "iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURSQsBhUANisZNR0oMDQwN0ctDVEbMVIxOGokOjJBOE1EOWxJORgESygQUhw2UjA1SxIRchgZeDINbSsWazYbbCcYdRcmdjErc0YbTHodS04yUG8wUVIbb0ccdVMncXU2dmYkangqaWkod3gsdzdIUxhGZjFNbTR5d09OUmxXU3VbXV9jXXNuWnZnWlJUbmxXbXZcZldscG1rdGtpaXhnZ3d2aXh4doIoP9RsPON2P4sbU5ExVaY9SaU7VoszcoMuZqc+b4RbW7BEULdJS7VGV41tW5RDea5EdbZHaI1xbIprZq59dstWU8hYTMlWV9RmTdZoSd11RthnVOFsVeV6Sep4Vs9bcspWZ8hXedl4bttnatpneOVxbOl4aeV2dEGDfnaDfu2HPoeJfa+Ndu6PU+uFSfSIWPmVWt6CbeyObeyGZvWIZ/uWZNWgff+iZhUfkAkchxYchicdgg4qigYnmBYllzIujhMxqwoupQU1qgk4tzMws00okVcmhm0vi3g1mE4wqkczt1g1uGs5tGg1qHg4phNOjitNjyJomhBMsy1QrhtwuCVosUZEinhZild5hXlyi0FHqnRHuVdmoHBquA08wyo5yTc4yDg72E071Uk3yVc5yGI+xBJS0AVHyAlL1AJX2DFK2Bxz0ypt1Rla7wVZ5ytX6ShJ5jhJ5jpV7CZX9Dpb9Rxy7QJm6ANr+AJ4/hl7+yp17Cln/jZl/Cd2+1ZGy0hG3FdI2HhRzGdGyXdJx2dL1VpozWVhwUpX7UZM5ERT6Udo9Y85j6M+lYs9rJNHl7xSk6hEh7ZLiqhFmLVMl4R1hrN+k5NNtZlFqolIt6xSrKZJpoxroKRyssdPi8hYidJdh8hYk8B/lNhlhOFpgoZNw1qDiXGHiW+dp2WisxqE1RWN6AWI/xiI/giY/xWY/i+P8iGD/ASo/xen/ga3/xa4/jS08kWv6hTE/wvD/zfC75GOirCLkqqEk5moi7O1jo6Pp5mysKWtpc2WkMW2j8GmorzCm6fPvpWyxgAAAOIVB1sAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgNS4xLjExiggWzgAAALhlWElmSUkqAAgAAAAFABoBBQABAAAASgAAABsBBQABAAAAUgAAACgBAwABAAAAAgAAADEBAgARAAAAWgAAAGmHBAABAAAAbAAAAAAAAABgAAAAAQAAAGAAAAABAAAAUGFpbnQuTkVUIDUuMS4xMQAAAwAAkAcABAAAADAyMzABoAMAAQAAAAEAAAAFoAQAAQAAAJYAAAAAAAAAAgABAAIABAAAAFI5OAACAAcABAAAADAxMDAAAAAABjXUc7KPcjsAAA9SSURBVFhHlZl5VNPnmsdzlRGlKlsAC4JsxSgaZC0WWVxBL0LY1GFxgJJkNIwCFlCBoEjYRKVcwbBjgBIWIUAACbeCAQXZ6S1l2DqSPYGKWz2dO06953l/id6Zc+g5PHD4gwOf8/k+z/O+vwRwH9ZU//P6japGRkZG/hPVyMjI69dv3rz+b/gJ3P//lT+qv9+VSKTNAoFIIBKJRDJlKaCWlpZe/vLuP9YIvNvM4UilUjEquVy+JF+Cr6paUSysDfj6MUcq5UiFQoSUi8VypeKSbHn5BRB/Obo2oITLlXI4UqFEgoAymQzLrZApFEsK+dLS8sE1Ad+0cLlcLkeIEguVbQTUkpKoWD54Yo1AqVQoFAtRXtVUFAqZQiZTrCwtLSl+2b13LcARxANB6N+nOYOfYmnlxQvF8u5dawG++eQnl8tl2EgUqs1ZWVpSLO9aE3CEK5SKpWKxUCyCgagmggQVKy9W1g6UCqXIUCCSi0Qy7BMpIiIA1xZ5pIUjhNAisUgul2E4VRex87K8b/eagFwORygUoIURyTDepxauvABDhzUBWzhSIYcjgMxKqLKTAMQM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"),
     ExportMetadata("BackgroundColor", "White"),
     ExportMetadata("PrimaryFontColor", "Indigo"),
     ExportMetadata("SecondaryFontColor", "Gray")]
    public class TmdlPluginTool : PluginBase
    {
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new PluginControl();
        }
    }
}
